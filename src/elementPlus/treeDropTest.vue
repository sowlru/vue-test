<template>
  <el-tree
    :allow-drop="allowDrop"
    :data="dataSource"
    :props="defaultProps"
    draggable
    node-key="id"
    @node-drop="handleDrop"
  >
    <template #default="{ node }">
      <span class="custom-tree-node">
        <span>{{ node.label }}</span>
      </span>
    </template>
  </el-tree>
</template>
<script>
export default {
  data() {
    return {
      dataSource: [
        {
          id: 100,
          name: '100 - –û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è',
          children: [
            { id: 110, name: '110 - –û–± —ç—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ' },
            { id: 120, name: '120 - –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏' }
          ]
        },
        {
          id: 200,
          name: '200 - –®–∞—Å—Å–∏',
          children: [
            {
              id: 210,
              name: '210 - –ü–æ–¥–≤–µ—Å–∫–∞',
              children: [
                { id: 211, name: '211 - –ü–µ—Ä–µ–¥–Ω—è—è –ø–æ–¥–≤–µ—Å–∫–∞' },
                { id: 212, name: '212 - –ó–∞–¥–Ω—è—è –ø–æ–¥–≤–µ—Å–∫–∞' }
              ]
            },
            { id: 220, name: '220 - –ö–æ–ª–µ—Å–∞ –∏ —Å—Ç—É–ø–∏—Ü—ã' }
          ]
        }
      ],
      defaultProps: {
        children: 'children',
        label: 'name',
        id: 'id'
      }
    }
  },
  mounted() {},
  methods: {
    allowDrop(draggingNode, dropNode, type) {
      if (dropNode.data.name === 'treeLevel two 3-1') {
        return type !== 'inner'
      } else {
        return true
      }
    },
    handleDrop(draggingNode, dropNode, type, ev) {
      const child = draggingNode.data
      const parent = dropNode.data
      console.log(
        'üöÄ ~ file: treeDropTest.vue:58 ~ handleDrop',
        {
          child
        },
        { parent },
        { type },
        { ev }
      )
      const params = {}
      params.flowChartItem_id = child.id
      console.log(
        'üöÄ ~ file: treeDropTest.vue:73 ~ handleDrop ~ params:',
        params
      )
    }
  }
}
</script>
